const advicePopup=document.querySelector("#advice-popup"),adviceForm=document.querySelector("#advice-popup-form"),adviceSubmit=document.querySelector("#advice-form-submit"),adviceNode=document.querySelectorAll(".advice"),advices=[...adviceNode];advices.forEach((e=>{e.addEventListener("click",(()=>{if(body.classList.add("lock"),advicePopup.classList.add("active"),userPhone.length>0&&userName.length>0)return isEmailValid(userMail)&&userMail.length>0&&(adviceMail.value=userMail),adviceName.value=userName,advicePhone.value=userPhone,void adviceFormValidate(event);isEmailValid(userMail)&&userMail.length>0?adviceMail.value=userMail:userName.length>0?adviceName.value=userName:userPhone.length>0&&(advicePhone.value=userPhone)}))})),document.querySelector("#advice-popup-close").addEventListener("click",(function(){body.classList.remove("lock"),advicePopup.classList.remove("active")}));const advicePhone=document.querySelector("#advice-phone"),advicePhoneError=document.querySelector("#advice-phone-error");function advicePhoneShowError(){return advicePhone.validity.valueMissing?(advicePhoneError.textContent="Введите телефон",advicePhone.style.borderBottom="1px solid red",!1):advicePhone.value.length<18?(advicePhone.style.borderBottom="1px solid red",advicePhoneError.textContent="Поле заполнено не полностью",!1):(advicePhone.style.borderBottom="1px solid #D1D3D4",advicePhoneError.textContent="",userPhone=advicePhone.value,advicePhone.blur(),!0)}advicePhone.addEventListener("input",mask,!1),advicePhone.addEventListener("focus",mask,!1),advicePhone.addEventListener("blur",mask,!1),advicePhone.addEventListener("keydown",mask,!1),advicePhone.addEventListener("keyup",mask,!1),advicePhone.addEventListener("input",advicePhoneShowError,!1),advicePhone.addEventListener("focus",advicePhoneShowError,!1),advicePhone.addEventListener("blur",advicePhoneShowError,!1),advicePhone.addEventListener("keydown",advicePhoneShowError,!1),advicePhone.addEventListener("keyup",advicePhoneShowError,!1);const adviceMail=document.querySelector("#advice-mail"),adviceMailError=document.querySelector("#advice-mail-error");function adviceMailShowError(){return isEmailValid(adviceMail.value)?adviceMail.validity.rangeOverflow?(adviceMail.style.borderBottom="1px solid red",adviceMailError.textContent="Превышен лимит символов",!1):(userMail=adviceMail.value,!0):(adviceMailError.textContent="Введите корректный адрес",adviceMail.style.borderBottom="1px solid red",!1)}adviceMail.addEventListener("input",(function(){if(isEmailValid(adviceMail.value))return adviceMailError.textContent="",adviceMail.style.borderBottom="1px solid #D1D3D4",!0;adviceMailShowError()}));const adviceName=document.querySelector("#advice-name"),adviceNameError=document.querySelector("#advice-name-error");function adviceNameShowError(){adviceName.validity.valueMissing?adviceNameError.textContent="Введите имя":adviceName.validity.typeMismatch?adviceNameError.textContent="Введите имя корректно":adviceName.validity.rangeOverflow?adviceNameError.textContent="Превышен лимит симолов":(userName=adviceName.value,console.log(userName))}function adviceFormValidate(e){e.preventDefault(),adviceName.validity.valid?adviceNameError.textContent="":adviceNameShowError(),advicePhone.validity.valid?advicePhoneError.textContent="":advicePhoneShowError(),isEmailValid(adviceMail.value)?adviceMailError.textContent="":adviceMailShowError(),adviceName.validity.valid&&advicePhone.validity.valid?(adviceSubmit.removeAttribute("disabled"),adviceSubmit.addEventListener("click",sendAdviceForm)):adviceSubmit.setAttribute("disabled","disabled")}function sendAdviceForm(){let e=adviceName.value,a=adviceMail.value;const i={fun:"2",name:e,phone:advicePhone.value,email:a};var o,d;console.log(i),o=formUrl,d=i,BX.showWait(),$.ajax({type:"POST",url:o,data:d,dataType:"json",success:function(e){console.log(e.code),e.code&&"200"==e.code?(advicePopup.classList.remove("active"),popupSuccess.classList.add("active")):(advicePopup.classList.remove("active"),popupFail.classList.add("active"))},error:function(e){console.log(e),advicePopup.classList.remove("active"),popupFail.classList.add("active")},complete:function(){BX.closeWait()}})}adviceName.addEventListener("input",(function(){adviceName.validity.valid?(userName=adviceName.value,adviceNameError.textContent="",adviceName.style.borderBottom="1px solid #D1D3D4"):adviceNameShowError()})),adviceForm.addEventListener("change",(function(e){adviceFormValidate(e)}));