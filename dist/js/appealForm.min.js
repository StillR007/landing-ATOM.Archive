const appealPopup=document.querySelector("#appeal-popup"),appealsNode=document.querySelectorAll(".appeal"),appeals=[...appealsNode];appeals.forEach((e=>{e.addEventListener("click",(()=>{if(menu.classList.contains("active")&&burger.click(),body.classList.add("lock"),appealPopup.classList.add("active"),userPhone.length>0&&userName.length>0)return isEmailValid(userMail)&&userMail.length>0&&(appealMail.value=userMail),appealName.value=userName,appealPhone.value=userPhone,void formValidate(event);isEmailValid(userMail)&&userMail.length>0?appealMail.value=userMail:userName.length>0?appealName.value=userName:userPhone.length>0&&(appealPhone.value=userPhone)}))})),document.querySelector("#appeal-popup-close").addEventListener("click",(function(){body.classList.remove("lock"),appealPopup.classList.remove("active")}));const appealForm=document.querySelector("#appeal-popup-form"),appealMail=document.querySelector("#appeal-mail"),appealMailError=document.querySelector("#appeal-mail-error"),appealNextStep=document.querySelector("#appeal-form-next"),appealName=document.querySelector("#appeal-name"),appealNameError=document.querySelector("#appeal-name-error"),appealPhone=document.querySelector("#appeal-phone"),appealPhoneError=document.querySelector("#appeal-phone-error");function appealMailShowError(){isEmailValid(appealMail.value)?appealMail.validity.rangeOverflow?(appealMail.style.borderBottom="1px solid red",appealMailError.textContent="Превышен лимит символов"):userMail=appealMail.value:(appealMailError.textContent="Введите корректный адрес",appealMail.style.borderBottom="1px solid red")}function appealNameShowError(){appealName.validity.valueMissing?appealNameError.textContent="Введите имя":appealName.validity.typeMismatch?appealNameError.textContent="Введите имя корректно":appealName.validity.rangeOverflow?appealNameError.textContent="Превышен лимит симолов":userName=appealName.value}function appealPhoneShowError(){return appealPhone.validity.valueMissing?(appealPhoneError.textContent="Введите телефон",appealPhone.style.borderBottom="1px solid red",!1):appealPhone.value.length<18?(appealPhone.style.borderBottom="1px solid red",appealPhoneError.textContent="Поле заполнено не полностью",!1):(appealPhone.style.borderBottom="1px solid #D1D3D4",appealPhoneError.textContent="",userPhone=appealPhone.value,appealPhone.blur(),!0)}function nextStep(){document.querySelector("#appeal-form-step-1").classList.add("done"),document.querySelector("#appeal-popup-progress-1").classList.add("done"),document.querySelector("#appeal-form-step-2").classList.add("active"),document.querySelector("#appeal-popup-progress-2").classList.add("active")}function formValidate(e){e.preventDefault(),appealName.validity.valid?appealNameError.textContent="":appealNameShowError(),appealPhone.validity.valid?appealPhoneError.textContent="":appealPhoneShowError(),isEmailValid(appealMail.value)?appealMailError.textContent="":appealMailShowError(),appealName.validity.valid&&appealPhone.validity.valid&&isEmailValid(appealMail.value)?(appealNextStep.removeAttribute("disabled"),appealNextStep.addEventListener("click",nextStep)):appealNextStep.setAttribute("disabled","disabled")}function sendAppealForm(){let e=appealName.value,a=appealMail.value;const p={fun:"1",name:e,phone:appealPhone.value,email:a,type:dropInput.value};var l,t;console.log(p),l=formUrl,t=p,BX.showWait(),$.ajax({type:"POST",url:l,data:t,dataType:"json",success:function(e){console.log(e.code),e.code&&"200"==e.code?(appealPopup.classList.remove("active"),popupSuccess.classList.add("active")):(appealPopup.classList.remove("active"),popupFail.classList.add("active"))},error:function(e){console.log(e),appealPopup.classList.remove("active"),popupFail.classList.add("active")},complete:function(){BX.closeWait()}})}appealMail.addEventListener("input",(function(){isEmailValid(appealMail.value)?(userMail=appealMail.value,appealMailError.textContent="",appealMail.style.borderBottom="1px solid #D1D3D4"):appealMailShowError()})),appealName.addEventListener("input",(function(){appealName.validity.valid?(userName=appealName.value,appealNameError.textContent="",appealName.style.borderBottom="1px solid #D1D3D4"):appealNameShowError()})),appealPhone.addEventListener("input",mask,!1),appealPhone.addEventListener("focus",mask,!1),appealPhone.addEventListener("blur",mask,!1),appealPhone.addEventListener("keydown",mask,!1),appealPhone.addEventListener("keyup",mask,!1),appealPhone.addEventListener("input",appealPhoneShowError,!1),appealPhone.addEventListener("focus",appealPhoneShowError,!1),appealPhone.addEventListener("blur",appealPhoneShowError,!1),appealPhone.addEventListener("keydown",appealPhoneShowError,!1),appealPhone.addEventListener("keyup",appealPhoneShowError,!1),appealForm.addEventListener("change",(function(e){formValidate(e)}));const dropdown=document.querySelector("#appeal-dropdown"),dropContent=document.querySelector("#appeal-dropdown-inner"),dropInput=document.querySelector("#appeal-type"),formSubmit=document.querySelector("#appeal-form-submit"),dropItemsNode=dropContent.querySelectorAll("p"),dropItems=[...dropItemsNode];dropdown.addEventListener("click",(function(){dropContent.classList.add("active")})),dropItems.forEach((e=>{e.addEventListener("click",(function(){dropContent.classList.contains("active")&&dropContent.classList.remove("active"),dropdown.innerText=e.innerText,dropInput.value=e.innerText,formSubmit.hasAttribute("disabled")&&formSubmit.removeAttribute("disabled"),formSubmit.addEventListener("click",sendAppealForm)}))}));